---
 - hosts: all
   gather_facts: no
 
   tasks:
 
<<<<<<< HEAD
   - name: Add ubuntu user to the sudoers
=======
   - name: Enable Passwordless Authentication
>>>>>>> 4c66bbb50304830d44c65e0ad3bad675e1ad4643
     copy:
          dest: "/etc/sudoers.d/90-cloud-init-users"
          content: "ubuntu ALL=(ALL) NOPASSWD: ALL"
 
   - name: Disable Password Authentication
     lineinfile:
           dest=/etc/ssh/sshd_config
           regexp='^PasswordAuthentication'
           line="PasswordAuthentication no"
           state=present
           backup=yes
     notify:
       - restart ssh
 
<<<<<<< HEAD
   - name: Disable Challenge Response Authentication 
     lineinfile:
           dest=/etc/ssh/sshd_config
           regexp='^ChallengeResponseAuthentication'
           line='ChallengeResponseAuthentication no'
           state=present
           backup=yes
     notify:
       - restart ssh

   - name: Disable Use PAM 
     lineinfile:
           dest=/etc/ssh/sshd_config
           regexp='^UsePAM'
           line='UsePAM no'
=======
   - name: Disable Challenge Response Authentication
     lineinfile:
           dest=/etc/ssh/sshd_config
           regexp='^ChallengeResponseAuthentication'
           line="ChallengeResponseAuthentication no"
>>>>>>> 4c66bbb50304830d44c65e0ad3bad675e1ad4643
           state=present
           backup=yes
     notify:
       - restart ssh
       
   - name: Disable Use PAM
     lineinfile:
           dest=/etc/ssh/sshd_config
           regexp='^UsePAM'
           line="UsePAM no"
           state=present
           backup=yes
     notify:
       - restart ssh       
 
   handlers:
   - name: restart ssh
     service:
       name=sshd
       state=restarted
